::: {#fb-root}
:::

::: topbar
[](http://buck.build/)

# Buck

-   
-   [Docs](/setup/getting_started.html)
-   [Issues](https://github.com/facebook/buck/issues)
-   [GitHub](https://github.com/facebook/buck)
:::

::: socialBanner
Support Ukraine. [Help Provide Humanitarian Aid to
Ukraine](https://opensource.fb.com/support-ukraine).
:::

::: {.section .content}
::: width
# Flavors

::: overview
Flavors in Buck are a way to specify different variations of a build
that otherwise share most configuration specifications.

Flavors can also be used to simultaneously build for two different
platforms, such as iOS and watchOS. Being able to build for both of
these at the same time is important because iOS application can have a
dependency on the Watch application.

Flavors fall into a number of different categories:

-   [Platform](#platform_http)
-   [Linker](#linker_http)
-   [Symbol](#symbol_http)
-   [Analysis](#analysis_http)
-   [Header](#header_http)
-   [Apple debug](#apple_debug_http)
-   [Apple bundles](#apple_bundles_http)

## Syntax for flavors

A flavor is specified as a suffix to a build target, with the hash mark
(#) used as a separator between the target and flavor. Examples:

    buck build :cxx_gr_name#default
    buck build :cxx_gr_name#iphonesimulator-x86_64

You can specify multiple flavors for a single target by separating the
flavors with commas:

    buck build Libraries/3rdParty/openssl:ssl#android-armv7,static-pic
    buck build Libraries/3rdParty/openssl:ssl#android-x86,static-pic
    buck build :bundle#iphoneos-x86_64,strip-all,dwarf-and-dsym

**NOTE:** Buck supports a [build target
pattern](/concept/build_target_pattern.html),`...`, as in, `//apps/...`,
that specifies that Buck should recurse through build files in
subdirectories, building all build targets in any build files it finds.
*This build target pattern does not support specifying flavors.*

### Default flavors

The `cxx_library` and `apple_library` rules support specifying *default
flavors*, which pertain if a build target is specified 1)
explicitly-that is, not using a [build target
pattern](/concept/build_target_pattern.html)-and 2) without a flavor.

### Syntax for Flagfile Flavors

A flavor may also be specified as a suffix to an \@file or \--flagfile
argument. These flavors are used within the flagfile only and do not
directly change the target flavor. The separator is \'#\' as above, and
if the separator and flavor are present, the \@file (aka flagfile) must
end in \".py\" and be a Python script. The script will be called as
follows:

    python /path/to/flagfile.py --flavors 

## Platform flavors [\#](#platform_http){.inline-link} {#platform_http}

These flavors denote a toolchain to use for compiling. You can also use
them to control conditional fields in the Buck target\'s rule.

  Flavor                   Meaning
  ------------------------ -------------------------------
  android-armv7            32-bit Android device
  android-x86              32-bit Android emulator
  iphoneos                 
  iphoneos-armv7           32-bit iPhone device
  iphoneos-arm64           64-bit iPhone device
  iphoneos-i386            
  iphoneos-x86_64          
  iphonesimulator          
  iphonesimulator-i386     Simulator on 32-bit Mac
  iphonesimulator-x86_64   Simulator on 64-bit Mac
  macosx-x86_64            Native x86_64 OSX application
  macosx-arm64             Native arm64 OSX application
  windows-x86_64           Native Windows application

Sighted in the wild:

    buck build :main#android-arm64,shared

## Linker flavors [\#](#linker_http){.inline-link} {#linker_http}

### Static

    static

Static library (.a)

### Position-independent code (PIC)

    static-pic

Static library that generates position-independent code (PIC). Note that
on the Apple platforms, everything is PIC.

### Shared

A shared library (so) or dynamically-loaded module (.dylib on Mac, .dll
on Windows).

### Shared interface

    shared-interface

A stub library that only lists the imports and exports of a shared
library. You can link against this library, but it doesn\'t have any
executable code.

### Linker Map

    no-linkermap

Specifying this flavor suppresses the generation of a LinkMap.txt file,
which is normally generated by the Apple linker (ld).

## Analysis flavors [\#](#analysis_http){.inline-link} {#analysis_http}

### Rust language

    check

The Rust compiler has a build mode which quickly checks syntax and type
correctness, but avoids codegen (which is the slowest phase of Rust
compilation). This flavor invokes check on the suffixed build target.

    save-analysis

The `#save-analysis` flavor is an extension of #check. It performs the
same actions as a #check build, but also emits a .json file containing
full type/symbol cross-reference information, for consumption by tools
like RLS (Rust Language Services).

    doc

The `#doc` flavor is the equivalent of the cargo doc command. It uses
the rustdoc tool to generate documentation for a target and its
dependencies.

### Compilation database

If you specify one of these flavors, Buck generates analysis information
about your build.

    compilation-database

Produces a JSON file that contains (an approximation of) the compiler
commands for compiling each file. The output is in the [clang
compilation
database](https://eli.thegreenplace.net/2014/05/21/compilation-databases-for-clang-based-tools)
format.

### Infer

    infer-analyze
    infer-capture-all

These flavors run [Facebook\'s Infer tool](https://fbinfer.com) and
generate intermediate Infer output.

## Symbol stripping flavors[\#](#symbol_http){.inline-link} {#symbol_http}

These flavor control how symbols are stripped from an output binary.

### Strip debug

    strip-debug

Strip debug symbols; equivalent to `strip -S`.

### Strip debug and non-external

    strip-non-global

Strip debug and non-external symbols; equivalent to `strip -x`.

### Strip all

    strip-all

Strip all the things; equivalent to strip with no arguments.

## Header Flavors[\#](#header_http){.inline-link} {#header_http}

These flavors are used with C++ header files, in the deps or
exported_deps attributes of a Buck target.

### Headers used to compile a libraries own files

    private-headers

Symlink tree, or header map, of headers used for compiling a library\'s
own files.

### Headers used to compile files that depend on this library

    headers

Symlink tree, or header map, of headers used to compile files for other
libraries that depend on this library.

## Apple debug flavors[\#](#apple_debug_http){.inline-link} {#apple_debug_http}

Selects the actual binary used to represent a
[`cxx_binary`](/rule/cxx_binary.html).

### Stripped binary

    no-debug

Selects the stripped binary

### Unstripped binary

    dwarf

Selects the unstripped binary

### Unstripped + dsym

    dwarf-and-dsym

Selects the unstripped binary, and the dsym file.

### Other

    apple-debuggable-binary

Could be stripped and unstripped, depending on requirements.

## Apple bundles flavors[\#](#apple_bundles_http){.inline-link} {#apple_bundles_http}

These flavors are legacy methods of creating app and framework bundles.

*You should not use these.*

Instead of these flavors, we now use the Buck rule,
[`apple_bundle`](/rule/apple_bundle.html)

### App

    app
    binary#app

Generates an app bundle.

### Framework

    framework
    library#framework

Generates a framework.
:::

### The Basics

-   [Getting Started](/setup/getting_started.html)
-   [Key Concepts](/about/overview.html)
-   [Tutorial](/learning/tutorial.html)
-   [Installing the IntelliJ
    Plugin](/setup/intellij_plugin_install.html)
-   [Exopackage](/article/exopackage.html)
-   [Buck Cheat Sheet](/article/query_cheat_sheet.html)

### About

-   [What Makes Buck so Fast?](/concept/what_makes_buck_so_fast.html)
-   [Showcase](/about/showcase.html)
-   [Troubleshooting](/concept/troubleshooting.html)
-   [Performance Tuning](/about/performance_tuning.html)
-   [FAQ](/concept/faq.html)
-   [Learn More (Buck Presentations)](/presentations/index.html)

### Concepts

-   [Build Rule](/concept/build_rule.html)
-   [Build File](/concept/build_file.html)
-   [Build Target](/concept/build_target.html)
-   [Build Target Pattern](/concept/build_target_pattern.html)
-   [Buck Daemon (buckd)](/concept/buckd.html)
-   [Visibility](/concept/visibility.html)
-   [Flavors](/concept/flavors.html)
-   [HTTP Cache API](/concept/http_cache_api.html)
-   [Rule Keys](/concept/rule_keys.html)
-   [Java ABIs](/concept/java_abis.html)
-   [Skylark](/concept/skylark.html)

### Files and Directories

-   [.buckconfig](/files-and-dirs/buckconfig.html)
-   [.buckjavaargs](/files-and-dirs/buckjavaargs.html)
-   [buck-out](/files-and-dirs/buck-out.html)

### Commands

-   [Common Parameters](/command/common_parameters.html)
-   [buck audit](/command/audit.html)
-   [buck build](/command/build.html)
-   [buck clean](/command/clean.html)
-   [buck doctor](/command/doctor.html)
-   [buck fetch](/command/fetch.html)
-   [buck fix](/command/fix.html)
-   [buck install](/command/install.html)
-   [buck kill](/command/kill.html)
-   [buck killall](/command/killall.html)
-   [buck project](/command/project.html)
-   [buck publish](/command/publish.html)
-   [buck query](/command/query.html)
-   [buck run](/command/run.html)
-   [buck root](/command/root.html)
-   [buck server](/command/server.html)
-   [buck targets](/command/targets.html)
-   [buck test](/command/test.html)
-   [buck uninstall](/command/uninstall.html)
-   [Exit Codes](/command/exit_codes.html)

### Build Rules

-   **Core**
-   [command_alias()](/rule/command_alias.html)
-   [export_file()](/rule/export_file.html)
-   [filegroup()](/rule/filegroup.html)
-   [genrule()](/rule/genrule.html)
-   [http_archive()](/rule/http_archive.html)
-   [http_file()](/rule/http_file.html)
-   [remote_file()](/rule/remote_file.html)
-   [test_suite()](/rule/test_suite.html)
-   [worker_tool()](/rule/worker_tool.html)
-   [zip_file()](/rule/zip_file.html)
-   **Android**
-   [android_aar()](/rule/android_aar.html)
-   [android_binary()](/rule/android_binary.html)
-   [android_build_config()](/rule/android_build_config.html)
-   [android_instrumentation_apk()](/rule/android_instrumentation_apk.html)
-   [android_instrumentation_test()](/rule/android_instrumentation_test.html)
-   [android_library()](/rule/android_library.html)
-   [android_manifest()](/rule/android_manifest.html)
-   [android_prebuilt_aar()](/rule/android_prebuilt_aar.html)
-   [android_resource()](/rule/android_resource.html)
-   [apk_genrule()](/rule/apk_genrule.html)
-   [gen_aidl()](/rule/gen_aidl.html)
-   [keystore()](/rule/keystore.html)
-   [ndk_library()](/rule/ndk_library.html)
-   [prebuilt_jar()](/rule/prebuilt_jar.html)
-   [prebuilt_native_library()](/rule/prebuilt_native_library.html)
-   [robolectric_test()](/rule/robolectric_test.html)
-   **CXX**
-   [cxx_binary()](/rule/cxx_binary.html)
-   [cxx_library()](/rule/cxx_library.html)
-   [cxx_genrule()](/rule/cxx_genrule.html)
-   [cxx_precompiled_header()](/rule/cxx_precompiled_header.html)
-   [cxx_test()](/rule/cxx_test.html)
-   [prebuilt_cxx_library()](/rule/prebuilt_cxx_library.html)
-   [prebuilt_cxx_library_group()](/rule/prebuilt_cxx_library_group.html)
-   **D**
-   [d_binary()](/rule/d_binary.html)
-   [d_library()](/rule/d_library.html)
-   [d_test()](/rule/d_test.html)
-   **Go**
-   [go_binary()](/rule/go_binary.html)
-   [go_library()](/rule/go_library.html)
-   [go_test()](/rule/go_test.html)
-   [cgo_library()](/rule/cgo_library.html)
-   **Groovy**
-   [groovy_library()](/rule/groovy_library.html)
-   **Halide**
-   [halide_library()](/rule/halide_library.html)
-   **Haskell**
-   [haskell_binary()](/rule/haskell_binary.html)
-   [haskell_library()](/rule/haskell_library.html)
-   [prebuilt_haskell_library()](/rule/prebuilt_haskell_library.html)
-   **iOS**
-   [apple_asset_catalog()](/rule/apple_asset_catalog.html)
-   [apple_binary()](/rule/apple_binary.html)
-   [apple_bundle()](/rule/apple_bundle.html)
-   [apple_library()](/rule/apple_library.html)
-   [apple_package()](/rule/apple_package.html)
-   [apple_resource()](/rule/apple_resource.html)
-   [apple_test()](/rule/apple_test.html)
-   [core_data_model()](/rule/core_data_model.html)
-   [prebuilt_apple_framework()](/rule/prebuilt_apple_framework.html)
-   **Java**
-   [java_binary()](/rule/java_binary.html)
-   [java_library()](/rule/java_library.html)
-   [java_test()](/rule/java_test.html)
-   [prebuilt_jar()](/rule/prebuilt_jar.html)
-   [prebuilt_native_library()](/rule/prebuilt_native_library.html)
-   **Kotlin**
-   [kotlin_library()](/rule/kotlin_library.html)
-   [kotlin_test()](/rule/kotlin_test.html)
-   **Lua**
-   [cxx_lua_extension()](/rule/cxx_lua_extension.html)
-   [lua_binary()](/rule/lua_binary.html)
-   [lua_library()](/rule/lua_library.html)
-   **OCaml**
-   [ocaml_binary()](/rule/ocaml_binary.html)
-   [ocaml_library()](/rule/ocaml_library.html)
-   **Python**
-   [prebuilt_python_library()](/rule/prebuilt_python_library.html)
-   [python_binary()](/rule/python_binary.html)
-   [python_library()](/rule/python_library.html)
-   [python_test()](/rule/python_test.html)
-   **Rust**
-   [rust_binary()](/rule/rust_binary.html)
-   [rust_library()](/rule/rust_library.html)
-   [rust_test()](/rule/rust_test.html)
-   [prebuilt_rust_library()](/rule/prebuilt_rust_library.html)
-   **Shell**
-   [sh_binary()](/rule/sh_binary.html)
-   [sh_test()](/rule/sh_test.html)
-   **.NET**
-   [csharp_library()](/rule/csharp_library.html)
-   [prebuilt_dotnet_library()](/rule/prebuilt_dotnet_library.html)

### Functions

-   **Python DSL**
-   [add_build_file_dep()](/function/add_build_file_dep.html)
-   [allow_unsafe_import()](/function/allow_unsafe_import.html)
-   [flatten_dicts()](/function/flatten_dicts.html)
-   [glob()](/function/glob.html)
-   [get_base_path()](/function/get_base_path.html)
-   [get_cell_name()](/function/get_cell_name.html)
-   [host_info()](/function/host_info.html)
-   [include_defs()](/function/include_defs.html)
-   [load()](/function/load.html)
-   [read_config()](/function/read_config.html)
-   [subdir_glob()](/function/subdir_glob.html)
-   [String Parameter Macros](/function/string_parameter_macros.html)

```{=html}
<!-- -->
```
-   **Skylark**
-   [glob()](/skylark/generated/glob.html)
-   [host_info()](/skylark/generated/host_info.html)
-   [package_name()](/skylark/generated/package_name.html)
-   [provider()](/skylark/generated/provider.html)
-   [read_config()](/skylark/generated/read_config.html)
-   [repository_name()](/skylark/generated/repository_name.html)
-   [rule_exists()](/skylark/generated/rule_exists.html)

### Extending Buck

-   [Custom Macros](/extending/macros.html)
-   [Custom Rules](/extending/rules.html)
-   [Building E2E Tests for Buck](/extending/e2e_tests.html)
:::
:::

::: width
© Copyright Facebook, 2013 - 2020
:::
